<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">

{%- include head.html -%}

<script>
// Apply saved theme immediately to prevent flash
(function() {
    var theme = localStorage.getItem('theme');
    if (theme === 'dark') document.documentElement.classList.add('dark');
    else if (theme === 'light') document.documentElement.classList.add('light');
})();
</script>

<body>
    {%- include header.html -%}

    {{ content }}

    {%- include footer.html -%}

    <script>
    (function() {
        var btn = document.querySelector('.theme-toggle');

        function isDark() {
            return document.documentElement.classList.contains('dark') ||
                (!document.documentElement.classList.contains('light') &&
                 window.matchMedia('(prefers-color-scheme: dark)').matches);
        }

        btn.addEventListener('click', function() {
            if (isDark()) {
                document.documentElement.classList.remove('dark');
                document.documentElement.classList.add('light');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.classList.remove('light');
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        });
    })();
    </script>
</body>

</html>
